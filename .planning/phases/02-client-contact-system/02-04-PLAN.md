---
phase: 02-client-contact-system
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/shared/ViewEditToggle.tsx
  - src/index.css
  - tailwind.config.js
  - src/pages/clients/ClientDetailPage.tsx
  - src/pages/clients/ClientsPage.tsx
autonomous: false

must_haves:
  truths:
    - "ViewEditToggle component exists and can be imported"
    - "ClientDetailPage uses ViewEditToggle component for edit mode"
    - "ClientsPage and ClientDetailPage have #f4f4f4 page backgrounds"
    - "Cards/containers use white (#ffffff) backgrounds"
  artifacts:
    - path: "src/components/shared/ViewEditToggle.tsx"
      provides: "Reusable view/edit toggle pattern"
      exports: ["ViewEditToggle"]
    - path: "src/index.css"
      provides: "CSS custom properties for IBM Carbon colors"
      contains: "--carbon-gray-10"
    - path: "tailwind.config.js"
      provides: "Tailwind theme extension for Carbon colors"
      contains: "carbon"
  key_links:
    - from: "src/pages/clients/ClientDetailPage.tsx"
      to: "ViewEditToggle"
      via: "component import (future refactor)"
      pattern: "ViewEditToggle"
---

<objective>
Create reusable UI components and apply IBM Carbon design tokens

Purpose: Extract ViewEditToggle pattern for reuse across detail pages; apply IBM Carbon aesthetic (#f4f4f4 backgrounds, white cards)
Output: Shared component + design tokens ready for use
</objective>

<execution_context>
@/Users/ayazmohammed/.claude/get-shit-done/workflows/execute-plan.md
@/Users/ayazmohammed/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-client-contact-system/02-RESEARCH.md

# Pattern source
@src/pages/clients/ClientDetailPage.tsx
@src/index.css
@tailwind.config.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ViewEditToggle shared component</name>
  <files>src/components/shared/ViewEditToggle.tsx</files>
  <action>
Create a reusable ViewEditToggle component extracted from ClientDetailPage pattern:

```typescript
import { Button } from '@/components/ui/button'
import { Edit, X, Save, Loader2 } from 'lucide-react'

interface ViewEditToggleProps {
  isEditing: boolean
  isSaving: boolean
  onEdit: () => void
  onCancel: () => void
  onSave: () => void
  editLabel?: string
  saveLabel?: string
  cancelLabel?: string
  children: {
    view: React.ReactNode
    edit: React.ReactNode
  }
}

export function ViewEditToggle({
  isEditing,
  isSaving,
  onEdit,
  onCancel,
  onSave,
  editLabel = 'Edit',
  saveLabel = 'Save',
  cancelLabel = 'Cancel',
  children,
}: ViewEditToggleProps) {
  return (
    <div>
      {/* Toggle buttons - right aligned */}
      <div className="flex justify-end gap-2 mb-4">
        {isEditing ? (
          <>
            <Button
              variant="outline"
              size="sm"
              onClick={onCancel}
              disabled={isSaving}
            >
              <X className="mr-2 h-4 w-4" />
              {cancelLabel}
            </Button>
            <Button
              size="sm"
              onClick={onSave}
              disabled={isSaving}
            >
              {isSaving ? (
                <Loader2 className="mr-2 h-4 w-4 animate-spin" />
              ) : (
                <Save className="mr-2 h-4 w-4" />
              )}
              {saveLabel}
            </Button>
          </>
        ) : (
          <Button
            variant="outline"
            size="sm"
            onClick={onEdit}
          >
            <Edit className="mr-2 h-4 w-4" />
            {editLabel}
          </Button>
        )}
      </div>

      {/* Content - switches between view and edit */}
      {isEditing ? children.edit : children.view}
    </div>
  )
}
```

This component:
- Matches existing ClientDetailPage pattern (lines 188-210)
- Provides consistent button styling
- Handles loading state with spinner
- Accepts customizable labels
- Uses render prop pattern for flexibility
  </action>
  <verify>
1. Run `npm run build` - no TypeScript errors
2. Component file exists at src/components/shared/ViewEditToggle.tsx
  </verify>
  <done>ViewEditToggle component created and exportable</done>
</task>

<task type="auto">
  <name>Task 2: Add IBM Carbon design tokens to Tailwind</name>
  <files>tailwind.config.js, src/index.css</files>
  <action>
1. **Update tailwind.config.js** - add Carbon color palette:

In the `extend.colors` section, add:
```javascript
carbon: {
  'gray-10': '#f4f4f4',  // Page backgrounds
  'gray-20': '#e0e0e0',  // Borders, dividers
  'gray-30': '#c6c6c6',  // Disabled backgrounds
  'gray-60': '#6f6f6f',  // Secondary text
  'gray-100': '#161616', // Primary text
  'blue-60': '#0f62fe',  // Primary action
  'blue-70': '#0043ce',  // Primary hover
  'white': '#ffffff',    // Card backgrounds
}
```

2. **Update src/index.css** - add CSS custom properties for theming:

After existing CSS variables in `:root`, add:
```css
/* IBM Carbon Design Tokens */
--carbon-gray-10: #f4f4f4;
--carbon-gray-20: #e0e0e0;
--carbon-gray-100: #161616;
--carbon-blue-60: #0f62fe;
--carbon-white: #ffffff;

/* Semantic aliases */
--page-background: var(--carbon-gray-10);
--card-background: var(--carbon-white);
--border-subtle: var(--carbon-gray-20);
```

3. **Add utility classes** to src/index.css:
```css
/* IBM Carbon Layout Utilities */
.page-carbon {
  background-color: var(--page-background);
  min-height: 100vh;
}

.card-carbon {
  background-color: var(--card-background);
  border-radius: 0.25rem;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}
```

Note: Do NOT apply these classes globally yet. This plan just adds the tokens. Future plans will apply them to specific pages.
  </action>
  <verify>
1. Run `npm run build` - no errors
2. Verify tailwind.config.js has carbon colors
3. Verify src/index.css has CSS custom properties
  </verify>
  <done>IBM Carbon design tokens available in Tailwind and CSS</done>
</task>

<task type="auto">
  <name>Task 3: Integrate ViewEditToggle into ClientDetailPage</name>
  <files>src/pages/clients/ClientDetailPage.tsx</files>
  <action>
Refactor ClientDetailPage to use the new ViewEditToggle component:

1. **Import the component**:
```typescript
import { ViewEditToggle } from '@/components/shared/ViewEditToggle'
```

2. **Replace the manual edit/save/cancel buttons** (around lines 188-210) with the ViewEditToggle component:

Find the section with Edit/Save/Cancel buttons and the conditional rendering of view vs edit content. Wrap it with ViewEditToggle:

```tsx
<ViewEditToggle
  isEditing={isEditing}
  isSaving={isSaving}
  onEdit={() => setIsEditing(true)}
  onCancel={handleCancelEdit}
  onSave={clientForm.handleSubmit(handleSaveClient)}
>
  {{
    view: (
      // Existing read-only client details display
      <div className="space-y-4">
        {/* Name, status badge, overview, etc. */}
      </div>
    ),
    edit: (
      // Existing Form with FormFields
      <Form {...clientForm}>
        {/* FormField components */}
      </Form>
    ),
  }}
</ViewEditToggle>
```

3. Keep all existing form logic (handleSaveClient, handleCancelEdit, clientForm) unchanged - just restructure the JSX.

4. Remove the duplicate Edit/Save/Cancel buttons that were previously inline.
  </action>
  <verify>
1. Run `npm run dev`
2. Navigate to a client detail page
3. Click Edit - verify form appears
4. Click Cancel - verify returns to view mode
5. Make a change and Save - verify saves correctly
6. Run `npm run build` - no TypeScript errors
  </verify>
  <done>ClientDetailPage uses ViewEditToggle component; edit/view toggle works correctly</done>
</task>

<task type="auto">
  <name>Task 4: Apply IBM Carbon styling to client pages</name>
  <files>src/pages/clients/ClientsPage.tsx, src/pages/clients/ClientDetailPage.tsx</files>
  <action>
Apply the IBM Carbon design tokens to client pages:

1. **ClientsPage.tsx** - Add page background:
   - Find the root container div (likely has className like "container" or "p-6")
   - Add `page-carbon` class or use `bg-carbon-gray-10 min-h-screen`
   - Example: `<div className="page-carbon p-6">`

2. **ClientDetailPage.tsx** - Add page background:
   - Find the root container div
   - Add `page-carbon` class or use `bg-carbon-gray-10 min-h-screen`
   - Example: `<div className="page-carbon">`

3. **Card styling** in both pages:
   - Find Card components or main content containers
   - Add `card-carbon` class or use `bg-white rounded shadow-sm`
   - Ensure cards stand out against the gray page background

4. **Verify visual hierarchy**:
   - Page background should be #f4f4f4 (light gray)
   - Cards/panels should be white (#ffffff)
   - This creates the IBM Carbon high-density look

Note: Only modify these two pages. Other pages will be updated in Phase 3.
  </action>
  <verify>
1. Run `npm run dev`
2. Navigate to /clients - verify gray page background with white cards
3. Navigate to /clients/:id - verify gray page background with white content cards
4. Check browser DevTools: page container should have background-color: #f4f4f4
5. Run `npm run build` - no errors
  </verify>
  <done>Client pages have IBM Carbon styling with #f4f4f4 backgrounds and white cards</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
ViewEditToggle component integrated into ClientDetailPage, IBM Carbon styling applied to client pages
  </what-built>
  <how-to-verify>
1. Run `npm run dev`
2. Navigate to /clients - verify page has light gray (#f4f4f4) background
3. Navigate to a client detail page - verify:
   - Page has gray background
   - Content cards are white
   - Edit button shows (ViewEditToggle working)
   - Click Edit - form appears
   - Click Cancel - returns to view
4. Check browser DevTools for correct colors
5. Run `npm run build` - passes
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe any issues</resume-signal>
</task>

</tasks>

<verification>
- ViewEditToggle component exists at src/components/shared/ViewEditToggle.tsx
- ClientDetailPage imports and uses ViewEditToggle component
- IBM Carbon colors available in Tailwind (bg-carbon-gray-10, etc.)
- CSS custom properties defined in :root
- ClientsPage and ClientDetailPage have #f4f4f4 backgrounds
- `npm run build` passes
</verification>

<success_criteria>
- ViewEditToggle integrated into ClientDetailPage (edit/view toggle works)
- IBM Carbon styling applied to client pages (#f4f4f4 bg, white cards)
- Design tokens available for Phase 3+ UI work
</success_criteria>

<output>
After completion, create `.planning/phases/02-client-contact-system/02-04-SUMMARY.md`
</output>
